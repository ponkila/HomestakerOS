# 2.1 Prepare the System

This guide covers all the preparatory work needed on your local machine before configuring and deploying HomestakerOS.

## Prerequisites

- A machine running any Linux as the underlying fallback operating system
- A drive for storing blockchain data and secret files
- Basic knowledge of Linux command line

## Storage Preparation

> **Important:** Proper storage setup is critical for your node's performance and data integrity. While HomestakerOS runs entirely in RAM, blockchain data and cryptographic secrets must be stored persistently to maintain synchronization and validator operations across reboots.

First, we need to prepare storage for your node:

1. **Check available drives and partitions**:

   ```bash
   lsblk -e7
   ```

   This command displays all drives and partitions.
Identify your target drive (e.g., `nvme0n1`).

2. **Format the target drive**:

   ```bash
   mkfs.ext4 -L homestaker /dev/nvme0n1
   ```

   This formats `/dev/nvme0n1` with a filesystem and the label "homestaker". Using a filesystem label allows HomestakerOS to reliably find and mount your storage regardless of device assignment changes.

3. **Mount the drive and create the necessary directories**:

   ```bash
   mkdir -p /mnt/nvme
   mount /dev/nvme0n1 /mnt/nvme
   mkdir -p /mnt/nvme/{secrets,erigon,lighthouse}
   ```

  Creating these directories in advance ensures proper organization of your persistent data, and allows us to reference them at the time of configuration. The `secrets` directory will store sensitive cryptographic material, while the client directories will store blockchain data.

## Secret Files Setup

> **Note:** In future versions of HomestakerOS, we are implementing [wirenix](https://man.sr.ht/~msalerno/wirenix/) and [agenix-rekey](https://github.com/oddlama/agenix-rekey), which will automatically generate secrets and create a wireguard mesh between nodes without manual configuration.

### JWT Secret

A JWT secret is essential to authenticate the connection between your beacon node and execution node:

1. **Generate the JWT**:

   ```bash
   openssl rand -hex 32 | tr -d "\n" > "/mnt/nvme/secrets/jwt.hex"
   ```

   This creates a strong random key that ensures only your authorized clients can communicate with each other. Without this authentication, malicious actors could potentially connect to your node's API endpoints.

### SSH Directory

Set up the SSH directory structure for host keys:

1. **Create the SSH directory**:

   ```bash
   mkdir -p /mnt/nvme/secrets/ssh
   ```

   This directory will store your node's SSH host keys persistently. Since HomestakerOS is ephemeral, storing these keys on persistent storage prevents SSH keys from rotating when rebooting your node.

## Next Steps

After preparing your system with the necessary filesystem and secrets, proceed to:

- [Configure and Deploy](2.2-configure_deploy.md) to set up your node using the HomestakerOS Web UI
- If you plan to use a VPN, consider preparing for [WireGuard VPN Setup](3.1-wireguard_vpn.md)
